import{a as i,E as b,ai as $,aI as j,o as g,b as F,d as a,c as s,e,w as d,aj as K,aR as Q,aH as v,f as h,aE as J,aG as C,p as W,g as X}from"./index.3e073952.js";import{u as Z}from"./usePagingList.7cc5691e.js";import{u as ee,_ as te}from"./ComSchemaForm.ddac7487.js";import{_ as ae}from"./_plugin-vue_export-helper.cdc0426e.js";import{h as S}from"./moment.9709ab41.js";import{r as c}from"./request.320a4cb6.js";import{q as re}from"./station.53f7a1d4.js";import{C as oe}from"./close.b7d868c7.js";import{a as ne}from"./index.bb6352d4.js";import{T as se}from"./index.1881d489.js";import{P as ie}from"./index.4e3ab62a.js";import{P as le}from"./index.d2d90e7b.js";import{B as I}from"./styleChecker.eb92c49d.js";import{S as de}from"./index.650eb3d7.js";import"./index.6751c452.js";import"./Modal.96e6e95e.js";import"./shallowequal.ccea8df8.js";import"./pickAttrs.d6d54610.js";import"./useDestroyed.98bfddca.js";import"./FormItemContext.3f5ce3ea.js";import"./treeData.11936c29.js";import"./index.ba495c24.js";import"./useState.2cff5e19.js";import"./Card.bc99f03d.js";import"./index.61a2edd1.js";import"./Col.061c78bf.js";import"./useFlexGapSupport.e5ca3a50.js";/* empty css                                                                   */import"./index.29c0fa28.js";import"./Form.6fa778b0.js";import"./dayjs.260c4fea.js";import"./FilterFilled.ebb64806.js";import"./index.da9ad678.js";const m="/server/charge_order/",ce=t=>c({method:"GET",url:m,params:t}),me=t=>c({method:"GET",url:m+t+"/"}),pe=t=>c({method:"DELETE",url:m+t+"/",data:{id:t}}),ue=t=>c({method:"PUT",url:m+t.order_id+"/",data:t}),_e=t=>c({method:"POST",url:"/server/realtimevisual/",data:{order_id:t},responseType:"arraybuffer"});const x=t=>(W("data-v-caa4cdc6"),t=t(),X(),t),ge={class:"page-wrap"},he={class:"page-head"},fe={class:"page-head"},ye=x(()=>a("div",{class:"fl"},null,-1)),be={class:"fr"},ve={class:"page-body"},Ce={class:"page-foot"},Se=x(()=>a("div",{class:"fl"},null,-1)),Ie={class:"fr"},xe={class:"pop-content"},Oe={class:"pop-box1"},ke=["src"],we=["src"],Pe={__name:"Order",setup(t){const p=i([]);i(!1);const u=i(!1);i({});const f=i(""),O=b(()=>[{name:"order_start_datetime",label:"Order start time",type:"datetime"},{name:"order_end_datetime",label:"Order end time",type:"datetime"},{name:"charge_capacity",label:"Charging capacity"},{name:"order_fee",label:"Total order cost"},{name:"pile_id_fk",label:"Charging Pile SN",names:"pile_sn"},{name:"appuser_id_fk",label:"Username",names:"appuser_username"}]);b(()=>[{name:"order_id",label:"Order ID"},{name:"name",label:"user name"},{name:"pile_id",label:"Charging Pile ID"}]);const{listData:k,loading:w,total:P,page:T,size:D,selectedKeys:Te,handleDelete:E,queryValues:De,handleChangeSelect:Ee,handleChangeQueryValues:L,handleChangePage:V,handleChangeSize:q,doQueryList:z}=Z({pk:"order_id",queryListAction:ce,deleteOneAction:pe}),{formTitle:M,formVisible:Y,formValues:B,handleCancel:N,handleModify:H,handleSubmit:U}=ee({queryOneAction:me,modifyOneAction:ue,editSuccessCallback:z,pk:"order_id"}),G=async r=>{console.log(r);let o=await _e(r);u.value=!0;const _=new Blob([o],{type:"image/jpeg"}),n=URL.createObjectURL(_);f.value=n},R=r=>{L({search:r})};i({options:[],pagination:{page:1,pageSize:10,total:0},isLoading:!0});const A=async()=>{const r=await re();return p.rawValue=r.results,p.rawValue.forEach(o=>{o.label=o.station_id,o.value=o.station_name}),{infos:p}};return $(()=>{A()}),(r,o)=>{const _=j("el-button");return g(),F("div",ge,[a("div",he,[s(e(le),{title:"Order Management"})]),a("div",fe,[ye,a("div",be,[s(e(ne),{type:"text",onSearch:R,allowClear:""})])]),a("div",ve,[s(e(se),{"row-key":"order_id",bordered:"","data-source":e(k),loading:e(w),pagination:!1,columns:[{title:"ID",dataIndex:"order_id",width:120,align:"center"},{title:"Order Number",dataIndex:"order_number",align:"center"},{title:"Order Start Time",dataIndex:"order_start_datetime",customRender:({text:n})=>e(S)(n).utc().format("YYYY-MM-DD HH:mm:ss"),align:"center"},{title:"Order End Time",dataIndex:"order_end_datetime",customRender:({text:n})=>e(S)(n).utc().format("YYYY-MM-DD HH:mm:ss"),align:"center"},{title:"Charging Capacity (Kw)",dataIndex:"charge_capacity_divided",align:"center"},{title:"Total Cost\uFF08include GST\uFF09",dataIndex:"order_fee",align:"center"},{title:"Charging Pile SN",dataIndex:["pile_id_fk","pile_sn"],align:"center"},{title:"User",dataIndex:["appuser_id_fk","appuser_firstname"],align:"center"},{title:"Order Status",dataIndex:"order_status",align:"center"},{title:"Operate",dataIndex:"action",width:250,align:"center"}]},{bodyCell:d(({column:n,record:l})=>[n.dataIndex==="order_number"?(g(),v(_,{key:l.order_number,text:"",onClick:y=>G(l.order_number)},{default:d(()=>[h(J(l.order_number),1)]),_:2},1032,["onClick"])):C("",!0),n.dataIndex==="action"?(g(),v(e(de),{key:1},{default:d(()=>[s(e(I),{type:"primary",onClick:y=>e(H)(l)},{default:d(()=>[h("modify")]),_:2},1032,["onClick"]),s(e(I),{type:"primary",danger:"",onClick:y=>e(E)(l)},{default:d(()=>[h("delete")]),_:2},1032,["onClick"])]),_:2},1024)):C("",!0)]),_:1},8,["data-source","loading","columns"])]),a("div",Ce,[Se,a("div",Ie,[s(e(ie),{current:e(T),"page-size":e(D),total:e(P),showSizeChanger:!1,hideOnSinglePage:"true",onChange:e(V),onShowSizeChange:e(q)},null,8,["current","page-size","total","onChange","onShowSizeChange"])])]),s(te,{width:800,visible:e(Y),title:e(M),fields:e(O),values:e(B),onSubmit:e(U),onCancel:e(N)},null,8,["visible","title","fields","values","onSubmit","onCancel"]),K(a("div",xe,[a("div",Oe,[a("img",{src:e(oe),class:"icon",style:{cursor:"pointer"},onClick:o[0]||(o[0]=()=>u.value=!1)},null,8,ke),a("img",{src:f.value},null,8,we)])],512),[[Q,u.value]])])}}},mt=ae(Pe,[["__scopeId","data-v-caa4cdc6"]]);export{mt as default};
