import{u as Q,_ as F}from"./ComSchemaForm.a2edeca4.js";import{u as K}from"./usePagingList.6da1d0b3.js";import{r as d,B as s}from"./request.62baea1e.js";import{B as U,o as p,b as G,d as i,c as n,e,w as o,f as r,am as m,al as H,m as y}from"./index.c40ba44a.js";import{P as J}from"./index.d9dc9e4e.js";import{P as R}from"./Card.e322202d.js";import{a as j}from"./index.ad22d2db.js";import{S as X}from"./index.a0603571.js";import{T as Y}from"./index.c3fa6db2.js";import{P as Z}from"./index.67f8f3a5.js";import{M as C}from"./Modal.e9d92ecd.js";import"./index.e65bc6a3.js";import"./debounce.48f4b242.js";import"./isSymbol.e344bab7.js";import"./treeData.11936c29.js";/* empty css                                                                   */import"./_plugin-vue_export-helper.cdc0426e.js";import"./useState.0374a5c3.js";import"./index.c4399b9e.js";import"./Col.065ba925.js";import"./useFlexGapSupport.244e6824.js";import"./station.735052cd.js";import"./index.1816c805.js";import"./useDestroyed.b4b7294a.js";import"./index.c1737657.js";import"./FilterFilled.90ebc0b2.js";const _="/server/get_charge_pile/",ee=a=>d({method:"GET",url:_,params:a}),te=a=>d({method:"POST",url:_,data:a}),ae=a=>d({method:"put",url:_+a.pile_id+"/",data:a}),S=a=>d({method:"DELETE",url:_+a+"/"}),le=async a=>{for(let h of a)await S(h)},ne=a=>d({method:"POST",url:"/server/start_ocpp/",timeout:999*1e3,data:a}),oe=a=>d({method:"POST",url:"/server/stop_ocpp/",timeout:999*1e3,data:a}),ie={class:"page-wrap"},se={class:"page-head"},re={class:"page-head"},de={class:"fl"},ce={class:"fr"},pe={class:"page-body"},ue={class:"page-foot"},me={class:"fl"},_e={class:"fr"},Qe={__name:"Pile",setup(a){const h=U(()=>[{name:"pile_charge_type",label:"Name"},{name:"pile_model",label:"Model"},{name:"pile_location_state",label:"State",type:"select",inputProps:{options:[{value:"nsw",label:"NSW"},{value:"tas",label:"TAS"},{value:"qld",label:"QLD"},{value:"vic",label:"VIC"},{value:"wa",label:"WA"},{value:"nt",label:"NT"},{value:"act",label:"ACT"},{value:"as",label:"AS"}]}},{name:"pile_sn",label:"SN"},{name:"pile_vendor",label:"Supplier"},{name:"pile_ratekw",label:"Power"},{name:"pile_connect_no",label:"Connect Number"},{name:"pile_outputcurrentmax",label:"Max output power"},{name:"pile_status",label:"Working Status",type:"select",inputProps:{options:[{value:"Available",label:"Available"},{value:"Unavailable",label:"Unavailable"}]}},{name:"station_id_fk",label:"Station Id Fk",type:"select",inputProps:{options:JSON.parse(localStorage.getItem("stationIdList"))}}]),{listData:v,loading:k,size:w,total:P,queryValues:he,selectedKeys:b,handleDelete:x,doQueryList:g,handleChangeSelect:I,handleChangeQueryValues:O,handleChangePage:A,handleChangeSize:N,handleDeleteList:T}=K({pk:"pile_id",queryListAction:ee,deleteOneAction:S,deleteListAction:le}),{formTitle:L,formVisible:M,formValues:V,handleCreate:z,handleModify:B,handleCancel:E,handleSubmit:q}=Q({pk:"pile_id",createOneAction:te,modifyOneAction:ae,editSuccessCallback:g}),$=l=>{O({search:l})},D=async l=>{console.log(l);let u="Are you sure to start?";const c={id_tag:l.pile_sn,connector_id:l.pile_connect_no,user_token:localStorage.getItem("token")};C.confirm({title:u,onOk:async()=>{try{const t=await ne(c);console.log(t),y.success(t.message),g()}catch(t){throw t}}})},W=async l=>{let u="Are you sure to stop?";const c={id_tag:l.pile_sn,connector_id:l.pile_connect_no,user_token:localStorage.getItem("token")};C.confirm({title:u,onOk:async()=>{try{const t=await oe(c);console.log(t),y.success(t.message),g()}catch(t){throw t}}})};return(l,u)=>(p(),G("div",ie,[i("div",se,[n(e(J),{title:"Charging Pile Management"})]),i("div",re,[i("div",de,[n(e(s),{type:"primary",onClick:e(z)},{default:o(()=>[n(e(R)),r("Add New Charging Pile ")]),_:1},8,["onClick"])]),i("div",ce,[n(e(j),{type:"text",onSearch:$,allowClear:""})])]),i("div",pe,[n(e(Y),{"row-key":"pile_id",bordered:"","data-source":e(v),loading:e(k),pagination:!1,columns:[{title:"Charging Pile ID",dataIndex:"pile_id"},{title:"Name",dataIndex:"pile_charge_type"},,{title:"Model",dataIndex:"pile_model",width:100,align:"center"},{title:"State",dataIndex:"pile_location_state",width:100,align:"center"},{title:"SN",dataIndex:"pile_sn",width:100,align:"center"},{title:"Supplier",dataIndex:"pile_vendor",width:100,align:"center"},{title:"Power",dataIndex:"pile_ratekw",width:100,align:"center"},{title:"Charging Pile Connect Number",dataIndex:"pile_connect_no",width:250,align:"center"},{title:"Max Output Power",dataIndex:"pile_outputcurrentmax",width:250,align:"center"},{title:"Working Status",dataIndex:"pile_status",width:250,align:"center"},{title:"Operate",dataIndex:"action",align:"center"}],"row-selection":{selectedRowKeys:e(b),onChange:e(I)}},{bodyCell:o(({column:c,record:t})=>[c.dataIndex==="action"?(p(),m(e(X),{key:0},{default:o(()=>[t.pile_status=="Available"?(p(),m(e(s),{key:0,onClick:f=>D(t),style:{width:"116px"}},{default:o(()=>[r("Start")]),_:2},1032,["onClick"])):t.pile_status=="Charging"?(p(),m(e(s),{key:1,onClick:f=>W(t),style:{width:"116px"}},{default:o(()=>[r("Stop ")]),_:2},1032,["onClick"])):(p(),m(e(s),{key:2,disabled:"",style:{width:"116px"}},{default:o(()=>[r("unavaliable")]),_:1})),n(e(s),{type:"primary",onClick:f=>e(B)(t)},{default:o(()=>[r("modify")]),_:2},1032,["onClick"]),n(e(s),{type:"primary",danger:"",onClick:f=>e(x)(t)},{default:o(()=>[r("delete")]),_:2},1032,["onClick"])]),_:2},1024)):H("",!0)]),_:1},8,["data-source","loading","row-selection"])]),i("div",ue,[i("div",me,[n(e(s),{danger:"",disabled:e(b).length===0,onClick:e(T)},{default:o(()=>[r("Delete All")]),_:1},8,["disabled","onClick"])]),i("div",_e,[n(e(Z),{current:l.page,"page-size":e(w),total:e(P),showSizeChanger:!1,onChange:e(A),onShowSizeChange:e(N),hideOnSinglePage:"true"},null,8,["current","page-size","total","onChange","onShowSizeChange"])])]),n(F,{width:800,visible:e(M),title:e(L),fields:e(h),values:e(V),onSubmit:e(q),onCancel:e(E)},null,8,["visible","title","fields","values","onSubmit","onCancel"])]))}};export{Qe as default};
