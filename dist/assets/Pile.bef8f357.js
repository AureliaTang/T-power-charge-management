import{u as Q,_ as F}from"./ComSchemaForm.7fadae25.js";import{u as K}from"./usePagingList.cf8e154d.js";import{r as c,B as s}from"./request.f6131b86.js";import{B as U,n as G,o as u,b as H,d as i,c as n,e,w as o,f as r,am as m,al as J,m as S}from"./index.2280ec3a.js";import{P as R}from"./index.60627ea8.js";import{P as j}from"./Card.6cdaaa11.js";import{a as X}from"./index.e8b0d794.js";import{S as Y}from"./index.cb967652.js";import{T as Z}from"./index.d3d777b6.js";import{P as ee}from"./index.4e9feb47.js";import{M as v}from"./Modal.e1ebeb99.js";import"./shallowequal.b569bcb1.js";import"./debounce.95684c51.js";import"./isSymbol.b7e4289f.js";import"./treeData.11936c29.js";import"./index.9acfb3cb.js";import"./pickAttrs.dc97a78a.js";import"./useState.91bfb08f.js";/* empty css                                                                   */import"./_plugin-vue_export-helper.cdc0426e.js";import"./index.b859e965.js";import"./Form.efd61807.js";import"./Col.f1645fdd.js";import"./useFlexGapSupport.ff982a16.js";import"./index.9ffc7d18.js";import"./station.d74a89f9.js";import"./dayjs.29a83cef.js";import"./index.8bc2d4c8.js";import"./useDestroyed.920d59f3.js";import"./index.7e849802.js";import"./FilterFilled.138365ee.js";const _="/server/get_charge_pile/",te=a=>c({method:"GET",url:_,params:a}),ae=a=>c({method:"POST",url:_,data:a}),le=a=>c({method:"put",url:_+a.pile_id+"/",data:a}),C=a=>c({method:"DELETE",url:_+a+"/"}),ne=async a=>{for(let h of a)await C(h)},oe=a=>c({method:"POST",url:"/server/start_ocpp/",timeout:999*1e3,data:a}),ie=a=>c({method:"POST",url:"/server/stop_ocpp/",timeout:999*1e3,data:a}),se={class:"page-wrap"},re={class:"page-head"},ce={class:"page-head"},de={class:"fl"},pe={class:"fr"},ue={class:"page-body"},me={class:"page-foot"},_e={class:"fl"},he={class:"fr"},Je={__name:"Pile",setup(a){const h=U(()=>[{name:"pile_charge_type",label:"Name"},{name:"pile_model",label:"Model"},{name:"pile_location_state",label:"State",type:"select",inputProps:{options:[{value:"nsw",label:"NSW"},{value:"tas",label:"TAS"},{value:"qld",label:"QLD"},{value:"vic",label:"VIC"},{value:"wa",label:"WA"},{value:"nt",label:"NT"},{value:"act",label:"ACT"},{value:"as",label:"AS"}]}},{name:"pile_sn",label:"SN"},{name:"pile_vendor",label:"Supplier"},{name:"charge_price",label:"Price"},{name:"pile_connect_no",label:"Connect Number"},{name:"pile_outputcurrentmax",label:"Max output power"},{name:"pile_status",label:"Working Status",type:"select",inputProps:{options:[{value:"Available",label:"Available"},{value:"Unavailable",label:"Unavailable"}]}},{name:"station_id_fk",label:"Station Id Fk",type:"select",inputProps:{options:JSON.parse(localStorage.getItem("stationIdList"))}}]),{listData:y,loading:k,size:w,total:x,queryValues:ge,selectedKeys:b,handleDelete:P,doQueryList:g,handleChangeSelect:I,handleChangeQueryValues:O,handleChangePage:A,handleChangeSize:N,handleDeleteList:T}=K({pk:"pile_id",queryListAction:te,deleteOneAction:C,deleteListAction:ne}),{formTitle:V,formVisible:L,formValues:M,handleCreate:z,handleModify:B,handleCancel:E,handleSubmit:q}=Q({pk:"pile_id",createOneAction:ae,modifyOneAction:le,editSuccessCallback:g}),$=l=>{O({search:l})},D=async l=>{console.log(l);let d="Are you sure to start?";const p={id_tag:l.pile_sn,connector_id:l.pile_connect_no,user_token:localStorage.getItem("token")};v.confirm({title:d,onOk:async()=>{try{const t=await oe(p);console.log(t),S.success(t.message),g()}catch(t){throw t}}})},W=async l=>{let d="Are you sure to stop?";const p={id_tag:l.pile_sn,connector_id:l.pile_connect_no,user_token:localStorage.getItem("token")};v.confirm({title:d,onOk:async()=>{try{const t=await ie(p);console.log(t),S.success(t.message),g()}catch(t){throw t}}})};return G(y,(l,d)=>{}),(l,d)=>(u(),H("div",se,[i("div",re,[n(e(R),{title:"Charging Pile Management"})]),i("div",ce,[i("div",de,[n(e(s),{type:"primary",onClick:e(z)},{default:o(()=>[n(e(j)),r("Add New Charging Pile ")]),_:1},8,["onClick"])]),i("div",pe,[n(e(X),{type:"text",onSearch:$,allowClear:""})])]),i("div",ue,[n(e(Z),{"row-key":"pile_id",bordered:"","data-source":e(y),loading:e(k),pagination:!1,columns:[{title:"ID",dataIndex:"pile_id"},{title:"Charging Pile SN",dataIndex:"pile_sn",width:100,align:"center"},{title:"Type",dataIndex:"pile_charge_type"},,{title:"Model",dataIndex:"pile_model",width:100,align:"center"},{title:"State",dataIndex:"pile_location_state",width:100,align:"center"},{title:"Supplier",dataIndex:"pile_vendor",width:100,align:"center"},{title:"Connect Number",dataIndex:"pile_connect_no",width:250,align:"center"},{title:"Max Output Power",dataIndex:"pile_outputcurrentmax",width:250,align:"center"},{title:"Price",dataIndex:"charge_price",width:100,align:"center"},{title:"Working Status",dataIndex:"pile_status",width:250,align:"center"},{title:"Operate",dataIndex:"action",align:"center"}],"row-selection":{selectedRowKeys:e(b),onChange:e(I)}},{bodyCell:o(({column:p,record:t})=>[p.dataIndex==="action"?(u(),m(e(Y),{key:0},{default:o(()=>[t.pile_status=="Available"?(u(),m(e(s),{key:0,onClick:f=>D(t),style:{width:"116px"}},{default:o(()=>[r("Start")]),_:2},1032,["onClick"])):t.pile_status=="Charging"?(u(),m(e(s),{key:1,onClick:f=>W(t),style:{width:"116px"}},{default:o(()=>[r("Stop ")]),_:2},1032,["onClick"])):(u(),m(e(s),{key:2,disabled:"",style:{width:"116px"}},{default:o(()=>[r("unavaliable")]),_:1})),n(e(s),{type:"primary",onClick:f=>e(B)(t)},{default:o(()=>[r("modify")]),_:2},1032,["onClick"]),n(e(s),{type:"primary",danger:"",onClick:f=>e(P)(t)},{default:o(()=>[r("delete")]),_:2},1032,["onClick"])]),_:2},1024)):J("",!0)]),_:1},8,["data-source","loading","row-selection"])]),i("div",me,[i("div",_e,[n(e(s),{danger:"",disabled:e(b).length===0,onClick:e(T)},{default:o(()=>[r("Delete All")]),_:1},8,["disabled","onClick"])]),i("div",he,[n(e(ee),{current:l.page,"page-size":e(w),total:e(x),showSizeChanger:!1,onChange:e(A),onShowSizeChange:e(N),hideOnSinglePage:"true"},null,8,["current","page-size","total","onChange","onShowSizeChange"])])]),n(F,{width:800,visible:e(L),title:e(V),fields:e(h),values:e(M),onSubmit:e(q),onCancel:e(E)},null,8,["visible","title","fields","values","onSubmit","onCancel"])]))}};export{Je as default};
